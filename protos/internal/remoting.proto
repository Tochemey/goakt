syntax = "proto3";

package internalpb;

import "google/protobuf/duration.proto";
import "internal/actor.proto";
import "internal/dependency.proto";
import "internal/grain.proto";
import "internal/passivation.proto";
import "internal/peers.proto";
import "internal/reentrancy.proto";

option go_package = "github.com/tochemey/goakt/v4/internal/internalpb;internalpb";

// RemoteAsk is used to send a message to an actor remotely and expect a response
// immediately.
message RemoteAskRequest {
  // Specifies the remote message to send
  repeated RemoteMessage remote_messages = 1;
  // Specifies the timeout(how long to wait for a reply)
  google.protobuf.Duration timeout = 2;
}

message RemoteAskResponse {
  // Specifies the message to send to the actor
  // Any proto message is allowed to be sent
  repeated bytes messages = 1;
}

// RemoteTell is used to send a message to an actor remotely
message RemoteTellRequest {
  // Specifies the remote message to send
  repeated RemoteMessage remote_messages = 1;
}

message RemoteTellResponse {}

// RemoteLookupRequest checks whether a given actor exists on a remote host
message RemoteLookupRequest {
  // Specifies the remote host address
  string host = 1;
  // Specifies the remote port
  int32 port = 2;
  // Specifies the actor name
  string name = 3;
}

message RemoteLookupResponse {
  // Specifies the actor address
  string address = 1;
}

// RemoteMessage will be used by Actors to communicate remotely
message RemoteMessage {
  // Specifies the sender' address
  string sender = 1;
  // Specifies the actor address
  string receiver = 2;
  // Specifies the message to send to the actor
  // Any proto message is allowed to be sent
  bytes message = 3;
}

message RemoteReSpawnRequest {
  // Specifies the remote host address
  string host = 1;
  // Specifies the remote port
  int32 port = 2;
  // Specifies the actor name
  string name = 3;
}

message RemoteReSpawnResponse {
  // Specifies the actor address
  string address = 1;
}

message RemoteStopRequest {
  // Specifies the remote host address
  string host = 1;
  // Specifies the remote port
  int32 port = 2;
  // Specifies the actor name
  string name = 3;
}

message RemoteStopResponse {}

message RemoteSpawnRequest {
  // Specifies the remote host address
  string host = 1;
  // Specifies the remote port
  int32 port = 2;
  // Specifies the actor name.
  string actor_name = 3;
  // Specifies the actor type
  string actor_type = 4;
  // Specifies if the actor is a singleton
  SingletonSpec singleton = 5;
  // Specifies if the actor is relocatable
  bool relocatable = 6;
  // Specifies the passivation strategy
  PassivationStrategy passivation_strategy = 7;
  // Specifies the dependencies
  repeated internalpb.Dependency dependencies = 8;
  //  States whether the actor will require a stash buffer
  bool enable_stash = 9;
  // Specifies the role the actor belongs to
  optional string role = 10;
  // Specifies the supervisor configuration when explicitly set
  SupervisorSpec supervisor = 11;
  // Specifies the reentrancy configuration when explicitly set
  ReentrancyConfig reentrancy = 12;
}

message RemoteSpawnResponse {
  // Specifies the actor address
  string address = 1;
}

message RemoteReinstateRequest {
  // Specifies the remote host address
  string host = 1;
  // Specifies the remote port
  int32 port = 2;
  // Specifies the actor name
  string name = 3;
}

message RemoteReinstateResponse {}

message RemoteAskGrainRequest {
  Grain grain = 1;
  bytes message = 2;
  google.protobuf.Duration request_timeout = 3;
}

message RemoteAskGrainResponse {
  bytes message = 1;
}

message RemoteTellGrainRequest {
  Grain grain = 1;
  bytes message = 2;
}

message RemoteTellGrainResponse {}

message RemoteActivateGrainRequest {
  Grain grain = 1;
}

message RemoteActivateGrainResponse {}

message PersistPeerStateRequest {
  // Specifies the peer state
  PeerState peer_state = 1;
}

message PersistPeerStateResponse {}

message TopicMessage {
  // Specifies the message unique id
  string id = 1;
  // Specifies the topic
  string topic = 2;
  // Specifies the message
  bytes message = 3;
}
