syntax = "proto3";

package internalpb;

import "internal/wireactor.proto";

option go_package = "github.com/tochemey/goakt/v2/internal/internalpb;internalpb";

// PeersService defines the peers service
service PeersService {
  // PeersSync synchronizes with other peers in the cluster
  rpc PeersSync(PeersSyncRequest) returns (PeersSyncResponse);
  // Redeploy re-distributes actors amongst the cluster members
  rpc Redeploy(RedeployRequest) returns (RedeployResponse);
}

// PeersSyncRequest is used to share a created/ restarted actor
// on a given node to his peers when cluster is enabled
message PeersSyncRequest {
  // Specifies the peer address
  string peer_address = 1;
  // Specifies the wire actor
  WireActor actor = 2;
}

// PeersSyncResponse is the response to SyncRequest
message PeersSyncResponse {}

// RedeployRequest is used to redistribute and recreate
// actors of the node that has left the cluster
message RedeployRequest {
  // Specifies the list of peers address
  repeated string peers = 1;
}

message RedeployResponse {}

message PeerState {
  // Specifies the node address
  string address = 1;
  // Specifies the list of actors
  repeated WireActor actors = 2;
}
